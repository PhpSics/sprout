<app-header></app-header>
<section class="inner_cont_body">
    <div class="container-fluid main_bg_white">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <app-side-menu></app-side-menu>

                <div class="admin_menus">
                    <div class="my_transport_all bg_admin_one">
                        <div class="goBack">
                            <a routerLink="/dashboard" class="btn"><i class="fa fa-chevron-left"></i> Back to Home</a>
                        </div>

                        <div class="transport_title">
                            <h3>My Messages</h3>
                            <a *ngIf="subjectId!=''" class="btn btn_goback" data-toggle="modal" data-target="#transport"><i class="fa fa-plus-circle"></i> Add </a>
                            <a *ngIf="subjectId==''" (click)="showAlert()" class="btn btn_goback"><i class="fa fa-plus-circle"></i> Add </a>
                        </div>

                        <div class="my_msgs">
                            <div class="selct_class_dropdown">
                                <div class="row">
                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                        <div class="form-group">
                                            <select class="form-control" (change)="changeClass($event)" name="classId" [(ngModel)]="model.classId">
                        <option value="">Select Class</option>
                        <option *ngFor="let class of classes; let i = index;" [attr.data-stream]="class.streamId"
                          [attr.data-index]="i" [attr.data-class]="class.classId" [attr.data-role]="class.roleId"
                          value="{{i}}">{{class.className}} {{class.streamName}}</option>
                      </select>
                                        </div>
                                    </div>
                                    <!-- ./col-lg-6 col-md-6 col-sm-12 col-xs-12 -->
                                    <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
                                        <div class="form-group">
                                            <select class="form-control" (change)="changeSubject($event.target.value)" name="subjectId" [(ngModel)]="model.subjectId">
                        <option value="">Select Subject</option>
                        <option *ngFor="let subject of subjects" value="{{subject.sId}}">{{subject.sName}}</option>
                      </select>
                                        </div>
                                    </div>
                                    <!-- ./col-lg-6 col-md-6 col-sm-12 col-xs-12 -->
                                </div>
                                <!-- ./row -->
                            </div>
                            <!-- ./selct_class_dropdown -->

                            <div class="teachr_msg_div" *ngFor="let message of messageNewList;let i=index;">
                                <a href="javascript:;" (click)="goToChatRoom(message.chatRoomId,i)">
                                    <div class="teachrMsg_img">
                                        <img *ngIf="message.image==''" src="{{defImgUrl}}">
                                        <img *ngIf="message.image!=''" src="{{Url+message.image}}">
                                    </div>
                                    <!-- ./teachrMsg_img -->
                                    <div class="teachrMsg_contnt">
                                        <ul>
                                            <li class="msg-title">{{message.uName}}</li>
                                            <li><span>{{message.createdAt | date:'yyyy-MM-dd hh:mm'}}</span></li>
                                        </ul>
                                        <p  [ngClass]="{'font-bold' :message.viewStatus === 1}">{{message.desc}}</p>
                                    </div>
                                    <!-- ./teachrMsg_contnt -->
                                </a>
                            </div>
                            <!-- ./teachr_msg_div -->

                        </div>
                        <!-- ./my_msgs -->
                    </div>
                </div>
                <!-- ./admin_menus -->
            </div>
            <!-- ./col-lg-12 col-md-12 col-sm-12 col-xs-12 -->
        </div>
        <!-- ./row -->
    </div>
    <!-- ./container-fluid -->
</section>
<!-- ./inner_cont_body -->
<!-- Transport popup -->
<div id="transport" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add Message</h4>
                <button type="button" class="close" data-dismiss="modal" #closeBtn>&times;</button>
            </div>
            <!-- ./modal-header -->
            <div class="modal-body">

                <div class="popup_p">
                    <form [formGroup]="msgForm" (ngSubmit)='sendMessage()' id="event-Frm">
                        <div class="form-group">
                            <ng-multiselect-dropdown [placeholder]="'Select Staffs'" [data]="staffs" name="staffId" formControlName="staffId" [settings]="staffSettings">
                            </ng-multiselect-dropdown>
                        </div>
                        <div class="form-group">
                            <ng-multiselect-dropdown [placeholder]="'Select Students'" [data]="students" name="toStudentId" formControlName="toStudentId" [settings]="studentSettings">
                            </ng-multiselect-dropdown>
                        </div>
                        <div class="form-group">
                            Add admin as recipient <input type="checkbox" formControlName="isAdmin">
                        </div>
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Topic" [ngClass]="{'error': submitted && f.topic.errors}" formControlName="topic">
                        </div>
                        <div class="form-group">
                            <textarea class="form-control" placeholder="Description" [ngClass]="{'error': submitted && f.msgText.errors}" formControlName="msgText"></textarea>
                        </div>
                        <div class="form-group">
                            <input type="submit" class="btn" value="Submit">
                        </div>
                    </form>
                </div>

            </div>
            <!-- ./modal-body -->
        </div>
        <!-- ./modal-content -->

    </div>
    <!-- ./modal-dialog -->
</div>
<!-- #/transport -->
<!-- ./inner_cont_body -->
<app-footer></app-footer>