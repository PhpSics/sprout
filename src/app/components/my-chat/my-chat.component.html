<app-header></app-header>
<section class="inner_cont_body">
    <div class="container-fluid main_bg_white">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <app-side-menu></app-side-menu>
                <div class="admin_menus">
                    <div class="my_transport_all bg_admin_one">
                        <div class="transport_title titles_tl">
                            <h3>Chat</h3>
                        </div>

                        <div class="chat-div">
                            <div class="chat-head-div" id="openModalButton" data-toggle="modal" data-target="#openModal"
                                (click)="openModal()">
                                <img *ngIf="ImgSrc==''" src="assets/images/user-default.png"> 
                                <img *ngIf="ImgSrc!=''" src="{{Url+ImgSrc}}">
                                <h5>{{chatName}}</h5>
                            </div>
                            <!-- ./chat-head-div -->
                            <div class="chat-body-div" id="msgcontainer-fluid" #scrollMe>
                                <div class="chat-text-div" *ngFor="let message of messageNewList"
                                    [ngClass]="{'chat-text-mine': message.isAdmin}">
                                    <div class="chat-userimage-div" *ngIf="message.message">
                                        <img *ngIf="message.image==''" src="{{imgUrl}}">
                                        <img *ngIf="message.image!=''" src="{{Url+message.image}}">
                                    </div>
                                    <div class="chat-txt-detail" *ngIf="message.message">
                                        <h5 *ngIf="!message.isAdmin">{{message.name}}</h5>
                                        <div class="chat-txtmsg">
                                            <p [innerHTML]="message.message | linky">{{message.message}}</p>
                                        </div>
                                        <h6 *ngIf="message.message">{{message.createdAt | date:'dd/MM/yyyy h:m a'}}</h6>
                                    </div>
                                </div>
                                <!-- ./chat-text-div -->
                            </div>
                            <!-- ./chat-body-div -->
                            <form *ngIf="chatRoomId!=undefined" [formGroup]="chatForm" (ngSubmit)='sendChat()'
                                (keydown)="keydownSubmit($event)">
                                <div class="chat-foot-div">
                                    <input *ngIf="chatType!='comment'" type="text" class="form-control"
                                        placeholder="Type here..." [ngClass]="{'error': submitted && f.msgText.errors}"
                                        formControlName="msgText">
                                    <input *ngIf="chatType=='comment'" type="text" class="form-control"
                                        placeholder="Type here..."
                                        [ngClass]="{'error': submitted && f.commentText.errors}"
                                        formControlName="commentText">
                                    <button class="chat-send" style="outline: none !important;color: #fe7414;"><i
                                            class="fa fa-paper-plane"></i></button>

                                    <!-- <button class="chat-attach" data-toggle="modal" data-target="#eventtransport">
                                      <i class="fa fa-paperclip"></i>
                                    </button> -->
                                </div>
                            </form>
                        </div>
                        <!-- ./chat-div -->

                    </div>
                </div>
                <!-- ./admin_menus -->
            </div>
        </div>
    </div>
</section>


<div id="eventtransport" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content -->
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Send Attachment</h4>
                <button type="button" class="close" data-dismiss="modal" #closeBtn>&times;</button>
            </div>
            <!-- ./modal-header -->
            <div class="modal-body">
                <div class="popup_p">
                    <form [formGroup]="attachmentForm" (ngSubmit)='sendMessage()'>
                        <!-- <div class="form-group">
                            <div class="row">
                                <div class="col-md-6">
                                    <select class="form-control" (change)="changeClass($event.target.value)" [ngClass]="{'error': submitted && f.classId.errors}" formControlName="classId">
                    <option value="">Select Class</option>
                    <option *ngFor="let cl of class" value="{{cl._id}}">{{cl.className}}</option>
                  </select>
                                </div>
                                <div class="col-md-6">
                                    <select class="form-control" (change)="changeStream($event.target.value)" [ngClass]="{'error': submitted && f.streamId.errors}" formControlName="streamId">
                    <option value="">Select Stream</option>
                    <option *ngFor="let stream of streams" value="{{stream._id}}">{{stream.streamName}}</option>
                  </select>
                                </div>
                            </div>
                        </div> -->
                        <!-- <div class="form-group">
                            <select class="form-control" [ngClass]="{'error': submitted && f.subject.errors}" formControlName="subject">
                <option value="">Select Subject</option>
                <option *ngFor="let subject of subjects" value="{{subject._id}}">{{subject.subjectName}}</option>
              </select>
                        </div> -->
                        <!-- <div class="form-group">
                            <input type="text" class="form-control" [ngClass]="{'error': submitted && f.uploadDate.errors}" placeholder="Upload Date" formControlName="uploadDate" id="uploadDate" [min]="today" matInput [matDatepicker]="picker" (click)="picker.open()" readonly>
                            <mat-datepicker [startAt]="today" #picker></mat-datepicker>
                        </div> -->
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Message"
                                [ngClass]="{'error': submitted && f.topic.errors}" formControlName="message">
                        </div>
                        <!-- <div class="form-group">
                            <input type="text" class="form-control" placeholder="Task" [ngClass]="{'error': submitted && f.description.errors}" formControlName="description">
                        </div> -->
                        <div class="form-group">
                            <input type="file" class="form-control" id="attachment">
                        </div>

                        <div class="form-group">
                            <input type="submit" class="btn" value="Send">
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>


<div id="openModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="openModalLabel"
    style="display: none;" aria-hidden="true" *ngIf="teachersData">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content" style="margin-bottom: 150px;">

            <div class="popup" style="margin: 28px;margin-top: 10px;width: 500px;height: auto;">
                <button style="padding-right: 46px;" type="button" class="close" data-dismiss="modal"
                    #closeBtn>&times;</button>
                <div *ngIf="teachersData" class="chat-head-div" style="width: 430px;">

                    <div style="align-items: center;">

                        <div style="font-weight: bold;">
                            <h3>{{chatName}}</h3>

                        </div>
                    </div>

                </div>
                <div *ngFor="let teacher of teachersData">
                    <div  *ngIf="teacher.studentfName" >
                      
                        <div class="chat-head-div" style="width: 430px;">
                            <img *ngIf="teacher.studentImage==''" src="assets/images/user-default.png">
                            <img *ngIf="teacher.studentImage!=''" src="{{Url+teacher.studentImage}}">
                            <h5>{{teacher.studentfName}}</h5>
                        </div>
                    </div>
                    <div  *ngIf="teacher.teacherName" >
                       
                        <div class="chat-head-div" style="width: 430px;">
                            <img *ngIf="teacher.teacherImage==''" src="assets/images/user-default.png">
                            <img *ngIf="teacher.teacherImage!=''" src="{{Url+teacher.teacherImage}}">
                            <h5>{{teacher.teacherName}}</h5>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
</div>

<app-footer></app-footer>